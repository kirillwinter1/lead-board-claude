# F19: Story AutoScore & Prioritization

## –¶–µ–ª—å

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è **Stories –≤–Ω—É—Ç—Ä–∏ Epic** –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤.

**–ö–ª—é—á–µ–≤–∞—è —Ü–µ–Ω–Ω–æ—Å—Ç—å:**
- –ö–æ–º–∞–Ω–¥–∞ –≤—Å–µ–≥–¥–∞ –∑–Ω–∞–µ—Ç –∫–∞–∫—É—é story –±—Ä–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–π
- –ë–∞–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–Ω–∏–º–∞—é—Ç—Å—è –Ω–∞–≤–µ—Ä—Ö
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ stories –æ—Ç–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —É—á—ë—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —á–µ—Ä–µ–∑ —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É

---

## Scope

**MVP (F19):**
- ‚úÖ –†–∞—Å—á—ë—Ç AutoScore –¥–ª—è –∫–∞–∂–¥–æ–π story
- ‚úÖ –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Å —É—á—ë—Ç–æ–º is blocked by / blocks
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –±–∞–≥–æ–≤ (–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- ‚úÖ –£—á—ë—Ç —Å—Ç–∞—Ç—É—Å–∞ story (–±–ª–∏–∂–µ –∫ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—é = –≤—ã—à–µ)
- ‚úÖ –£—á—ë—Ç Jira Priority (Highest > High > Medium > Low)
- ‚úÖ –£—á—ë—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (timeSpent/estimate)
- ‚úÖ –£—á—ë—Ç –Ω–∞–ª–∏—á–∏—è subtasks —Å estimates
- ‚úÖ –£—á—ë—Ç —Ñ–ª–∞–≥–æ–≤ (flagged = –Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–°–≤—è–∑—å —Å F25 (Manual Order):**
- AutoScore –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ **—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `manual_order` (drag & drop) ‚Äî —Å–º. [F25](F25_MANUAL_ORDER.md)
- ~~Manual priority boost~~ ‚Äî —É–¥–∞–ª—ë–Ω, –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ `manual_order`

---

## –§–æ—Ä–º—É–ª–∞ AutoScore –¥–ª—è Story

```
StoryAutoScore =
  + IssueTypeWeight        // Bug=100, Story=0
  + StatusWeight           // New=0, Ready=10, ..., Ready to Release=100 (—à–∞–≥ 10)
  + ProgressWeight         // (timeSpent/estimate) * 30
  + PriorityWeight         // Highest=40, High=30, Medium=20, Low=10
  + DependencyWeight       // blocks N stories = +10*N, is blocked by M = -1000 (–æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è)
  + DueDateWeight          // –î–µ–¥–ª–∞–π–Ω –±–ª–∏–∑–∫–æ = +30, –¥–∞–ª–µ–∫–æ = 0
  + EstimateQualityPenalty // –ù–µ—Ç subtasks —Å estimates = -100
  + FlaggedPenalty         // Flagged = -200 (–≤ –∫–æ–Ω–µ—Ü)
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** AutoScore –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π. –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ä—è–¥–æ–∫ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ–ª–µ–º `manual_order` ‚Äî —Å–º. [F25](F25_MANUAL_ORDER.md).

### –î–µ—Ç–∞–ª—å–Ω–∞—è —Ä–∞–∑–±–∏–≤–∫–∞ —Ñ–∞–∫—Ç–æ—Ä–æ–≤

#### 1. IssueTypeWeight (0-100)

| Issue Type | –í–µ—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|------------|-----|-------------|
| Bug, –ë–∞–≥, –î–µ—Ñ–µ–∫—Ç | 100 | –í—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
| Story, –ò—Å—Ç–æ—Ä–∏—è | 0 | –ë–∞–∑–æ–≤—ã–π |

#### 2. StatusWeight (0-100)

–°—Ç–∞—Ç—É—Å—ã Story —Å –≤–µ—Å–æ–º (—à–∞–≥ 10):

| –°—Ç–∞—Ç—É—Å | –í–µ—Å | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|-----|----------|
| **New / –ù–æ–≤–æ–µ** | **0** | –ù–∞—á–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å |
| Ready / –ì–æ—Ç–æ–≤–æ | 10 | –ì–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ |
| Analysis / –ê–Ω–∞–ª–∏–∑ | 20 | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ |
| Analysis Review | 30 | –†–µ–≤—å—é –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ |
| Waiting Dev | 40 | –û–∂–∏–¥–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| Development / –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ | 50 | –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ |
| Dev Review | 60 | –†–µ–≤—å—é –∫–æ–¥–∞ |
| Waiting QA | 70 | –û–∂–∏–¥–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è |
| Testing / –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | 80 | –í —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ |
| Test Review | 90 | –†–µ–≤—å—é —Ç–µ—Å—Ç–æ–≤ |
| **Ready to Release** | **100** | **–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç** |
| Done / –ì–æ—Ç–æ–≤–æ | 0 | –ó–∞–≤–µ—Ä—à–µ–Ω–æ, –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è |

**–ü—Ä–∞–≤–∏–ª–æ:** –°—Ç–∞—Ç—É—Å—ã –∏–¥—É—Ç –≤ –ø–æ—Ä—è–¥–∫–µ workflow, —á–µ–º –±–ª–∏–∂–µ –∫ —Ä–µ–ª–∏–∑—É ‚Äî —Ç–µ–º –≤—ã—à–µ –≤–µ—Å. Ready to Release –∏–º–µ–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (100).

#### 3. ProgressWeight (0-30)

```
ProgressWeight = (timeSpent / estimate) * 30

–ü—Ä–∏–º–µ—Ä—ã:
- 0% –ø—Ä–æ–≥—Ä–µ—Å—Å = 0
- 50% –ø—Ä–æ–≥—Ä–µ—Å—Å = 15
- 80% –ø—Ä–æ–≥—Ä–µ—Å—Å = 24
- 100% –ø—Ä–æ–≥—Ä–µ—Å—Å = 30
```

**–í–∞–∂–Ω–æ:** –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ subtasks (—Å–º. PROJECT_RULES.md).

–ï—Å–ª–∏ –Ω–µ—Ç subtasks —Å estimates: ProgressWeight = 0

#### 4. PriorityWeight (10-40)

| Jira Priority | –í–µ—Å |
|---------------|-----|
| Highest | 40 |
| High | 30 |
| Medium | 20 |
| Low | 10 |
| (–Ω–µ —É–∫–∞–∑–∞–Ω) | 15 |

#### 5. DependencyWeight

**Story blocks N –¥—Ä—É–≥–∏—Ö stories:**
```
DependencyWeight = +10 * N
```

–ü—Ä–∏–º–µ—Ä—ã:
- Blocks 1 story = +10
- Blocks 3 stories = +30
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –Ω–∏–∫–æ–≥–æ = 0

**Story is blocked by M –¥—Ä—É–≥–∏—Ö stories:**
```
DependencyWeight = -1000 * M
```

**–í–∞–∂–Ω–æ:** –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è story –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Ö–æ–¥–∏—Ç –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞ (–æ–≥—Ä–æ–º–Ω—ã–π —à—Ç—Ä–∞—Ñ).

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä—É—é—â–∏—Ö stories –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

#### 6. DueDateWeight (0-30)

```
–ï—Å–ª–∏ –µ—Å—Ç—å Due Date:
  - –î–æ –¥–µ–¥–ª–∞–π–Ω–∞ < 7 –¥–Ω–µ–π: +30
  - –î–æ –¥–µ–¥–ª–∞–π–Ω–∞ < 14 –¥–Ω–µ–π: +20
  - –î–æ –¥–µ–¥–ª–∞–π–Ω–∞ < 30 –¥–Ω–µ–π: +10
  - –î–µ–¥–ª–∞–π–Ω > 30 –¥–Ω–µ–π: 0
  - –î–µ–¥–ª–∞–π–Ω –ø—Ä–æ—Å—Ä–æ—á–µ–Ω: +40
–ò–Ω–∞—á–µ: 0
```

#### 7. EstimateQualityPenalty

```
–ï—Å–ª–∏ story –ë–ï–ó subtasks —Å estimates: -100
–ò–Ω–∞—á–µ: 0
```

**–ü—Ä–∞–≤–∏–ª–æ:** Story –±–µ–∑ subtasks —Å estimates –ù–ï –ú–û–ñ–ï–¢ –±—ã—Ç—å –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ (—Å–º. PROJECT_RULES.md).

#### 8. FlaggedPenalty

```
–ï—Å–ª–∏ story Flagged: -200
–ò–Ω–∞—á–µ: 0
```

**–ü—Ä–∞–≤–∏–ª–æ:** Flagged = —Ä–∞–±–æ—Ç–∞ –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ (—Å–º. PROJECT_RULES.md).

#### 9. ManualBoost (–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—Ä—É—á–Ω—É—é –ø–æ–≤—ã—Å–∏—Ç—å/–ø–æ–Ω–∏–∑–∏—Ç—å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞ –ª—é–±–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:
- –ß–µ—Ä–µ–∑ API: `PATCH /api/stories/{storyKey}/priority { "boost": 20 }`
- –ß–µ—Ä–µ–∑ Drag & Drop –≤ Board (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è boost)
- –ù–µ—Ç –≤–µ—Ä—Ö–Ω–µ–π/–Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã - –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ª—é–±–æ–µ —á–∏—Å–ª–æ

---

## –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –ê–ª–≥–æ—Ä–∏—Ç–º

1. **–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞:**
   - –í–µ—Ä—à–∏–Ω—ã = stories –≤–Ω—É—Ç—Ä–∏ epic
   - –†—ë–±—Ä–∞ = is blocked by / blocks

2. **–¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:**
   - –ù–∞—Ö–æ–¥–∏–º stories –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (in-degree = 0)
   - –ü–æ–º–µ—â–∞–µ–º –∏—Ö –≤ "—Å–ª–æ–π 0"
   - –£–¥–∞–ª—è–µ–º –∏—Ö –∏–∑ –≥—Ä–∞—Ñ–∞
   - –ü–æ–≤—Ç–æ—Ä—è–µ–º –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ª–æ—è

3. **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –≤–Ω—É—Ç—Ä–∏ —Å–ª–æ—è:**
   - Stories –≤ –∫–∞–∂–¥–æ–º —Å–ª–æ–µ —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ AutoScore (DESC)

### –ü—Ä–∏–º–µ—Ä

```
Story A (blocks B, blocks C)
Story B (blocked by A, blocks D)
Story C (blocked by A)
Story D (blocked by B)
Story E (no dependencies)

–ì—Ä–∞—Ñ:
A ‚Üí B ‚Üí D
A ‚Üí C
E (–æ—Ç–¥–µ–ª—å–Ω–æ)

–¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ —Å–ª–æ–∏:
–°–ª–æ–π 0: A (AutoScore=85), E (AutoScore=90)
  ‚Üí –ü–æ—Ä—è–¥–æ–∫: E, A (–ø–æ —É–±—ã–≤–∞–Ω–∏—é AutoScore)
–°–ª–æ–π 1: B (AutoScore=70), C (AutoScore=60)
  ‚Üí –ü–æ—Ä—è–¥–æ–∫: B, C
–°–ª–æ–π 2: D (AutoScore=50)

–ò—Ç–æ–≥–æ–≤—ã–π –ø–æ—Ä—è–¥–æ–∫: E ‚Üí A ‚Üí B ‚Üí C ‚Üí D
```

### Data Quality –ø—Ä–æ–≤–µ—Ä–∫–∏

–ü—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –≥—Ä–∞—Ñ–∞:

**STORY_BLOCKED_BY_MISSING** (ERROR):
- Story is blocked by –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é story
- Behaviour: –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º —ç—Ç—É —Å–≤—è–∑—å –ø—Ä–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–∏ –≥—Ä–∞—Ñ–∞

**STORY_CIRCULAR_DEPENDENCY** (ERROR):
- –¶–∏–∫–ª–∏—á–µ—Å–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å (A blocks B blocks A)
- Behaviour: –†–∞–∑—Ä—ã–≤–∞–µ–º —Ü–∏–∫–ª, –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –æ–±–µ stories –∫–∞–∫ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ

**STORY_BLOCKED_NO_PROGRESS** (WARNING):
- Story –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –±–æ–ª–µ–µ 30 –¥–Ω–µ–π –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –±–ª–æ–∫–∏—Ä—É—é—â–µ–π
- Behaviour: –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º, –Ω–æ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –í–ª–∏—è–Ω–∏–µ –Ω–∞ Expected Done

–ü—Ä–∏ —Ä–∞—Å—á—ë—Ç–µ Expected Done –¥–ª—è epic:

1. **–ë–µ—Ä—ë–º stories –≤ –ø–æ—Ä—è–¥–∫–µ AutoScore** (–ø–æ—Å–ª–µ —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏)
2. **–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ stories –æ—Ç–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è** –ø–æ–∫–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ
3. **–ë–∞–≥–∏ –º–æ–≥—É—Ç –≤–∫–ª–∏–Ω–∏–≤–∞—Ç—å—Å—è** –≤ —Å–µ—Ä–µ–¥–∏–Ω—É –ø–ª–∞–Ω–∞ (–µ—Å–ª–∏ –ø–æ—è–≤–∏–ª–∏—Å—å –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã)
4. **Flagged stories –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è** –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

---

## API

### –ü–æ–ª—É—á–µ–Ω–∏–µ stories —Å AutoScore

```http
GET /api/epics/{epicKey}/stories?sort=autoscore

Response:
{
  "stories": [
    {
      "storyKey": "LB-234",
      "summary": "Add user profile page",
      "issueType": "Story",
      "status": "Development",
      "priority": "High",
      "flagged": false,
      "autoScore": 95.5,
      "manualBoost": 10,
      "blockedBy": [],
      "blocks": ["LB-235", "LB-236"],
      "canStart": true,
      "estimateSeconds": 28800,  // –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–æ –∏–∑ subtasks
      "timeSpentSeconds": 14400, // –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–æ –∏–∑ subtasks
      "progress": 0.5,
      "scoreBreakdown": {
        "issueType": 0,
        "status": 80,
        "progress": 15,
        "priority": 30,
        "dependency": 20,  // blocks 2 stories
        "dueDate": 0,
        "estimateQuality": 0,
        "flagged": 0,
        "manual": 10
      },
      "subtasks": [
        {
          "subtaskKey": "LB-235",
          "summary": "Implement profile API",
          "issueType": "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞",
          "status": "In Progress",
          "assignee": "john.doe@example.com",
          "estimateSeconds": 14400,
          "timeSpentSeconds": 10800
        },
        {
          "subtaskKey": "LB-236",
          "summary": "Design profile UI",
          "issueType": "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞",
          "status": "New",
          "assignee": null,
          "estimateSeconds": 14400,
          "timeSpentSeconds": 3600
        }
      ]
    },
    ...
  ],
  "dependencyGraph": {
    "nodes": ["LB-234", "LB-235", "LB-236"],
    "edges": [
      { "from": "LB-234", "to": "LB-235", "type": "blocks" }
    ]
  }
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ manual boost

```http
PATCH /api/stories/{storyKey}/priority

Request:
{
  "boost": 20  // –õ—é–±–æ–µ —á–∏—Å–ª–æ, –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
}

Response:
{
  "storyKey": "LB-234",
  "autoScore": 115.5,  // –ü–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–æ
  "manualBoost": 20
}
```

### –ü–µ—Ä–µ—Å—á—ë—Ç AutoScore

```http
POST /api/planning/recalculate-stories?epicKey=LB-100

Response:
{
  "recalculated": 12,
  "timestamp": "2026-01-25T10:00:00Z"
}
```

---

## UI Changes

### Board Page

**–ö–æ–ª–æ–Ω–∫–∞ "Story Priority":**
- –ß–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ AutoScore
- –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è:
  - üü¢ High (>80)
  - üü° Medium (40-80)
  - üî¥ Low (<40)

**–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ stories –≤–Ω—É—Ç—Ä–∏ epic:**
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: –ø–æ AutoScore DESC
- –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –Ω–∞ —Ä—É—á–Ω—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç manual boost)

**Drag & Drop:**
- –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ story –≤–Ω—É—Ç—Ä–∏ epic
- –ü—Ä–∏ drop –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è manual boost –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ò–∫–æ–Ω–∫–∏:**
- üêõ Bug
- üîí Blocked (—Å tooltip: "Blocked by LB-123, LB-124")
- üö© Flagged
- ‚ö†Ô∏è No subtask estimates
- ‚ö° High priority (AutoScore > 80)

**Tooltip –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ AutoScore:**
```
AutoScore: 95.5

Breakdown:
  Issue Type: 0 (Story)
  Status: 80 (Development)
  Progress: 15 (50%)
  Priority: 30 (High)
  Dependency: +20 (blocks 2 stories)
  Due Date: 0
  Estimate Quality: 0
  Flagged: 0
  Manual Boost: +10
```

### Timeline Page

**Stories –≤ Timeline:**
- –ü–ª–∞–Ω–∏—Ä—É—é—Ç—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ AutoScore
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ stories –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—É–Ω–∫—Ç–∏—Ä–æ–º
- –ü—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ story - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ—á–µ–º—É –æ–Ω–∞ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ –≤ —ç—Ç–æ—Ç –ø–µ—Ä–∏–æ–¥

---

## –ü–µ—Ä–µ—Å—á—ë—Ç AutoScore

**–¢—Ä–∏–≥–≥–µ—Ä—ã:**
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π Jira sync (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ manual boost (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- –ü–æ –∫–Ω–æ–ø–∫–µ "Recalculate" –≤ UI (–≤—Ä—É—á–Ω—É—é)

**Scope:**
- –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö stories –≤—Å–µ—Ö epics –∫–æ–º–∞–Ω–¥—ã
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î (–ø–æ–ª–µ `autoScore`, `manualPriorityBoost`)

---

## Data Quality Rules

–ù–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è F19:

| –ü—Ä–∞–≤–∏–ª–æ | Severity | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|----------|
| `STORY_BLOCKED_BY_MISSING` | ERROR | Story blocked by –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é story |
| `STORY_CIRCULAR_DEPENDENCY` | ERROR | –¶–∏–∫–ª–∏—á–µ—Å–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å (A blocks B blocks A) |
| `STORY_BLOCKED_NO_PROGRESS` | WARNING | Story –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ >30 –¥–Ω–µ–π –±–µ–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ |
| `SUBTASK_ACTIVE_STORY_NOT_INPROGRESS` | WARNING | Subtask –∞–∫—Ç–∏–≤–Ω–∞, –Ω–æ story –Ω–µ –≤ —Ä–∞–±–æ—Ç–µ |

---

## Database Schema

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `jira_issues`

–î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫–∏:
```sql
ALTER TABLE jira_issues
ADD COLUMN auto_score DECIMAL(10, 2),
ADD COLUMN manual_priority_boost INTEGER DEFAULT 0,
ADD COLUMN flagged BOOLEAN DEFAULT FALSE,
ADD COLUMN blocks TEXT[], -- –º–∞—Å—Å–∏–≤ issue keys
ADD COLUMN is_blocked_by TEXT[]; -- –º–∞—Å—Å–∏–≤ issue keys
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** `blocks` –∏ `is_blocked_by` –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–∏ sync –∏–∑ Jira Issue Links.

---

## Tests

### Unit Tests

1. **AutoScore calculation:**
   - Bug vs Story
   - –°—Ç–∞—Ç—É—Å—ã (–≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã)
   - –ü—Ä–æ–≥—Ä–µ—Å—Å (0%, 50%, 100%)
   - Priority (Highest, High, Medium, Low)
   - Dependencies (blocks, is blocked by)
   - Due Date (–±–ª–∏–∑–∫–æ, –¥–∞–ª–µ–∫–æ, –ø—Ä–æ—Å—Ä–æ—á–µ–Ω)
   - Flagged
   - –ë–µ–∑ subtasks —Å estimates

2. **–¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:**
   - –ü—Ä–æ—Å—Ç–æ–π –≥—Ä–∞—Ñ (A ‚Üí B ‚Üí C)
   - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –≤–µ—Ç–∫–∏ (A ‚Üí B, A ‚Üí C)
   - –¶–∏–∫–ª—ã (–¥–æ–ª–∂–Ω—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è)
   - –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### Integration Tests

1. **API endpoints:**
   - GET /api/epics/{epicKey}/stories
   - PATCH /api/stories/{storyKey}/priority
   - POST /api/planning/recalculate-stories

2. **Jira sync:**
   - Issue Links —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è
   - Flagged status —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- F3 (Jira Sync) - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è Issue Links –∏ Flagged status
- F8 (Board v2) - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ stories –≤–Ω—É—Ç—Ä–∏ epic
- F13 (AutoPlanning) - —Ä–∞—Å—á—ë—Ç Expected Done —Å —É—á—ë—Ç–æ–º –ø–æ—Ä—è–¥–∫–∞ stories
- F18 (Data Quality) - –Ω–æ–≤—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è dependencies

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

- [ ] AutoScore —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö stories
- [ ] –¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ë–∞–≥–∏ –≤—Å–µ–≥–¥–∞ –Ω–∞–≤–µ—Ä—Ö—É —Å–ø–∏—Å–∫–∞
- [ ] –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ stories –≤ –∫–æ–Ω—Ü–µ
- [ ] Manual boost —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
- [ ] Drag & Drop —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ Board
- [ ] UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–∫–æ–Ω–∫–∏ –∏ AutoScore breakdown
- [ ] API endpoints —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã
- [ ] Data Quality –ø—Ä–∞–≤–∏–ª–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] –¢–µ—Å—Ç—ã –Ω–∞–ø–∏—Å–∞–Ω—ã –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
